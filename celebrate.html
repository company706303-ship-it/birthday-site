<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Celebrate</title>
  <style>
    :root{ --pink:#ff3b8a; }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(circle at top, #3a2a67 0%, #20163e 60%, #130c2a 100%);
      color:#fff;
      overflow:hidden;
    }

    /* ======= Top hanging balloons (many) ======= */
    .topBalloons{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:2;
    }
    .hBalloon{
      position:absolute;
      top:-40px;
      left:var(--x);
      width:48px;
      height:62px;
      border-radius:50% 50% 48% 48%;
      background: radial-gradient(circle at 30% 25%, rgba(255,255,255,.55), rgba(255,255,255,0) 35%),
                  var(--c);
      box-shadow: 0 18px 35px rgba(0,0,0,.25);
      transform-origin: top center;
      animation: hangSway 2.8s ease-in-out infinite alternate;
      animation-delay: var(--d);
      opacity:.95;
    }
    .hBalloon:after{
      content:"";
      position:absolute;
      left:50%;
      top:58px;
      width:2px;
      height:220px;
      background: rgba(255,255,255,.35);
      transform: translateX(-50%);
    }
    .hBalloon:before{
      content:"";
      position:absolute;
      left:50%;
      top:56px;
      width:10px;
      height:8px;
      background: rgba(255,255,255,.15);
      border-radius:0 0 8px 8px;
      transform: translateX(-50%) rotate(10deg);
    }
    @keyframes hangSway{
      from{ transform: rotate(-4deg) translateY(0); }
      to{ transform: rotate(4deg) translateY(2px); }
    }

    /* ======= Bunting (thread draws L -> R) ======= */
    .buntingLine{
      position:fixed;
      top:7%;
      left:0;
      width:100vw;
      z-index:3;
      pointer-events:none;
      transform: rotate(-6deg);
      transform-origin:left center;
    }
    .buntingLine .thread{
      height:3px;
      width:100%;
      background: rgba(255,255,255,.25);
      border-radius:999px;
      transform: scaleX(0);
      transform-origin:left center;
      animation: draw 1.2s ease-out forwards;
    }
    @keyframes draw{
      to{ transform: scaleX(1); }
    }

    .bunting{
      position:absolute;
      top:10px;
      left:0;
      width:100%;
      display:flex;
      justify-content:center;
      gap:10px;
      opacity:.95;
      animation: sway2 2.6s ease-in-out infinite alternate;
    }
    @keyframes sway2{
      from{ transform: translateY(0) rotate(-1deg); }
      to{ transform: translateY(2px) rotate(1deg); }
    }
    .tri{
      width:0;height:0;
      border-left:18px solid transparent;
      border-right:18px solid transparent;
      border-top:28px solid var(--c);
      filter: drop-shadow(0 10px 10px rgba(0,0,0,.25));
    }

    /* ======= lights ======= */
    .lights{
      position:fixed;
      top:12%;
      left:0;
      width:100vw;
      display:flex;
      justify-content:center;
      gap:14px;
      z-index:3;
      pointer-events:none;
      transform: rotate(-6deg);
      transform-origin:left center;
    }
    .bulb{
      width:10px; height:10px; border-radius:50%;
      background: var(--c);
      box-shadow: 0 0 18px var(--c);
      animation: blink 1.2s infinite alternate;
      animation-delay: var(--d);
    }
    @keyframes blink{ from{opacity:.35} to{opacity:1} }

    /* ======= center content ======= */
    .center{
      position:relative;
      width:min(920px, 94vw);
      margin:0 auto;
      min-height:100vh;
      display:grid;
      place-items:center;
      text-align:center;
      padding:26px 16px;
      z-index:4;
    }
    h1{
      margin:0 0 6px;
      font-size:44px;
      font-weight:900;
    }
    .sub{
      margin:0 0 18px;
      opacity:.9;
      font-size:14px;
    }
    .btn{
      border:0;
      padding:14px 24px;
      border-radius:999px;
      font-size:16px;
      font-weight:900;
      cursor:pointer;
      background: #ff6aa7;
      color:#fff;
      box-shadow: 0 14px 26px rgba(255,106,167,.3);
      margin-top:18px;
    }
    .btn:active{ transform: translateY(1px); }

    /* ======= Cake ======= */
    .cakeWrap{
      position:fixed;
      left:50%;
      bottom:-360px;
      transform:translateX(-50%);
      width:260px;
      height:360px;
      z-index:1;
      animation: rise 1.2s ease-out forwards;
      animation-delay:.2s;
    }
    @keyframes rise{ to{ bottom:-40px; } }
    .cakeWrap.off{
      animation: drop 0.9s ease-in forwards;
    }
    @keyframes drop{
      from{ bottom:-40px; opacity:1; }
      to{ bottom:-520px; opacity:0; }
    }

    .cake{
      position:absolute; bottom:0; left:50%;
      transform:translateX(-50%);
      width:260px;
    }
    .layer{
      height:90px;
      border-radius: 18px;
      background: #ff7bb3;
      border: 4px solid rgba(255,255,255,.15);
      box-shadow: 0 20px 35px rgba(0,0,0,.35);
      position:relative;
      overflow:hidden;
    }
    .layer::before{
      content:"";
      position:absolute; top:0; left:0; right:0; height:26px;
      background: rgba(255,255,255,.18);
      border-radius: 0 0 18px 18px;
    }
    .layer2{
      margin-top:-12px;
      background:#ff4f9a;
      transform: scaleX(.92);
    }
    .plate{
      margin-top:12px;
      height:16px;
      border-radius:999px;
      background: rgba(255,255,255,.25);
    }

    /* candles */
    .candles{
      position:absolute;
      top:-42px; left:50%;
      transform:translateX(-50%);
      display:flex;
      gap:14px;
    }
    .candle{
      width:14px; height:40px;
      border-radius:8px;
      background: #ffe6f2;
      position:relative;
      box-shadow: 0 8px 18px rgba(0,0,0,.25);
    }
    .candle:before{
      content:"";
      position:absolute;
      top:-16px; left:50%;
      transform:translateX(-50%);
      width:12px; height:16px;
      border-radius:50% 50% 50% 50%;
      background: radial-gradient(circle at 30% 30%, #fff3a6 0%, #ffb703 60%, #fb8500 100%);
      animation: flame .16s infinite alternate;
      box-shadow: 0 0 22px rgba(255,183,3,.55);
      opacity:1;
      transition: .25s ease;
    }
    @keyframes flame{
      from{ transform:translateX(-50%) scale(1) rotate(-2deg); }
      to{ transform:translateX(-50%) scale(1.08) rotate(2deg); }
    }
    /* Blow candles effect */
    body.blown .candle:before{
      opacity:0;
      box-shadow:none;
      transform:translateX(-50%) scale(.6);
      animation:none;
    }

    /* ======= floating confetti dots ======= */
    .dot{
      position:fixed;
      width:8px;height:8px;border-radius:50%;
      background: var(--c);
      box-shadow: 0 0 14px var(--c);
      opacity:.9;
      animation: float 6s linear infinite;
      top:110%;
      left:var(--x);
      animation-delay: var(--d);
      z-index:1;
      pointer-events:none;
    }
    @keyframes float{
      to{ transform: translateY(-140vh); }
    }

    /* ======= Bottom helium balloons (left/right) ======= */
    .helium{
      position:fixed;
      bottom:-30px;
      width:170px;
      height:260px;
      z-index:2;
      pointer-events:none;
      opacity:.95;
    }
    .helium.left{ left:12px; animation: heliFloat 3.6s ease-in-out infinite alternate; }
    .helium.right{ right:12px; animation: heliFloat 3.8s ease-in-out infinite alternate; }
    @keyframes heliFloat{
      from{ transform: translateY(0); }
      to{ transform: translateY(-10px); }
    }
    .helium .bigB{
      position:absolute;
      bottom:70px;
      left:50%;
      transform:translateX(-50%);
      width:150px;
      height:180px;
      border-radius:50%;
      background: radial-gradient(circle at 30% 25%, rgba(255,255,255,.55), rgba(255,255,255,0) 38%),
                  linear-gradient(180deg, #ff6aa7 0%, #ff3b8a 70%);
      box-shadow: 0 20px 40px rgba(0,0,0,.35);
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      padding:14px;
      font-weight:900;
      color:#fff;
      letter-spacing:.3px;
    }
    .helium.right .bigB{
      background: radial-gradient(circle at 30% 25%, rgba(255,255,255,.55), rgba(255,255,255,0) 38%),
                  linear-gradient(180deg, #8ecae6 0%, #4aa3df 75%);
    }
    .helium .knot{
      position:absolute;
      bottom:56px;
      left:50%;
      width:14px;
      height:10px;
      border-radius:0 0 10px 10px;
      background: rgba(255,255,255,.18);
      transform: translateX(-50%);
    }
    .helium .string{
      position:absolute;
      bottom:0;
      left:50%;
      width:2px;
      height:70px;
      background: rgba(255,255,255,.35);
      transform: translateX(-50%);
    }

    /* ======= Popup modal ======= */
    .modal{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:10;
      padding:18px;
    }
    .modal.show{ display:flex; }
    .modalCard{
      width:min(520px, 92vw);
      background: rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.18);
      backdrop-filter: blur(10px);
      border-radius:18px;
      padding:18px 16px;
      text-align:center;
      box-shadow: 0 30px 70px rgba(0,0,0,.45);
      animation: pop .25s ease-out both;
    }
    @keyframes pop{
      from{ transform: translateY(10px) scale(.98); opacity:0; }
      to{ transform: translateY(0) scale(1); opacity:1; }
    }
    .modalTitle{
      font-size:20px;
      font-weight:900;
      margin:0 0 8px;
    }
    .modalText{
      margin:0 0 14px;
      opacity:.95;
      font-size:14px;
      line-height:1.35;
    }
    .modalBtn{
      border:0;
      padding:12px 18px;
      border-radius:999px;
      font-size:15px;
      font-weight:900;
      cursor:pointer;
      background:#ffd166;
      color:#2b1b52;
      box-shadow: 0 14px 26px rgba(255,209,102,.25);
    }
    .modalBtn:active{ transform: translateY(1px); }
  </style>
</head>
<body>

  <!-- Top hanging balloons -->
  <div class="topBalloons" aria-hidden="true">
    <div class="hBalloon" style="--x:4vw;  --c:#ff6aa7; --d:.1s"></div>
    <div class="hBalloon" style="--x:10vw; --c:#ffd166; --d:.6s"></div>
    <div class="hBalloon" style="--x:16vw; --c:#8ecae6; --d:.3s"></div>
    <div class="hBalloon" style="--x:22vw; --c:#bdb2ff; --d:.9s"></div>
    <div class="hBalloon" style="--x:28vw; --c:#a0f4b7; --d:.2s"></div>
    <div class="hBalloon" style="--x:34vw; --c:#ff6aa7; --d:.8s"></div>
    <div class="hBalloon" style="--x:40vw; --c:#ffd166; --d:.4s"></div>
    <div class="hBalloon" style="--x:46vw; --c:#8ecae6; --d:1.0s"></div>
    <div class="hBalloon" style="--x:52vw; --c:#bdb2ff; --d:.5s"></div>
    <div class="hBalloon" style="--x:58vw; --c:#a0f4b7; --d:.7s"></div>
    <div class="hBalloon" style="--x:64vw; --c:#ff6aa7; --d:.15s"></div>
    <div class="hBalloon" style="--x:70vw; --c:#ffd166; --d:.95s"></div>
    <div class="hBalloon" style="--x:76vw; --c:#8ecae6; --d:.35s"></div>
    <div class="hBalloon" style="--x:82vw; --c:#bdb2ff; --d:.75s"></div>
    <div class="hBalloon" style="--x:88vw; --c:#a0f4b7; --d:.25s"></div>
    <div class="hBalloon" style="--x:94vw; --c:#ff6aa7; --d:.55s"></div>
  </div>

  <!-- Bunting line + flags -->
  <div class="buntingLine" aria-hidden="true">
    <div class="thread"></div>
    <div class="bunting">
      <div class="tri" style="--c:#3dd6d0"></div>
      <div class="tri" style="--c:#ffd166"></div>
      <div class="tri" style="--c:#ff6aa7"></div>
      <div class="tri" style="--c:#8ecae6"></div>
      <div class="tri" style="--c:#bdb2ff"></div>
      <div class="tri" style="--c:#a0f4b7"></div>
      <div class="tri" style="--c:#ff6aa7"></div>
      <div class="tri" style="--c:#ffd166"></div>
      <div class="tri" style="--c:#3dd6d0"></div>
      <div class="tri" style="--c:#bdb2ff"></div>
      <div class="tri" style="--c:#8ecae6"></div>
    </div>
  </div>

  <!-- Lights -->
  <div class="lights" aria-hidden="true">
    <div class="bulb" style="--c:#ff6aa7;--d:0s"></div>
    <div class="bulb" style="--c:#ffd166;--d:.2s"></div>
    <div class="bulb" style="--c:#8ecae6;--d:.4s"></div>
    <div class="bulb" style="--c:#a0f4b7;--d:.6s"></div>
    <div class="bulb" style="--c:#bdb2ff;--d:.8s"></div>
    <div class="bulb" style="--c:#ff6aa7;--d:1s"></div>
  </div>

  <!-- floating dots -->
  <div class="dot" style="--c:#ff6aa7;--x:10vw;--d:0s"></div>
  <div class="dot" style="--c:#ffd166;--x:20vw;--d:1s"></div>
  <div class="dot" style="--c:#8ecae6;--x:35vw;--d:2s"></div>
  <div class="dot" style="--c:#a0f4b7;--x:50vw;--d:1.4s"></div>
  <div class="dot" style="--c:#bdb2ff;--x:65vw;--d:.6s"></div>
  <div class="dot" style="--c:#ff6aa7;--x:80vw;--d:2.2s"></div>

  <!-- Bottom helium balloons -->
  <div class="helium left" aria-hidden="true">
    <div class="bigB">Happy<br/>Birthday</div>
    <div class="knot"></div>
    <div class="string"></div>
  </div>
  <div class="helium right" aria-hidden="true">
    <div class="bigB">Happy<br/>Birthday</div>
    <div class="knot"></div>
    <div class="string"></div>
  </div>

  <div class="center">
    <div>
      <h1>Letâ€™s Celebrate ðŸŽ‰</h1>
      <p class="sub">Click the button to decorate and open your surprise ðŸ’–</p>
      <button class="btn" id="go">Letâ€™s Celebrate</button>
    </div>
  </div>

  <!-- cake -->
  <div class="cakeWrap" id="cakeWrap" aria-hidden="true">
    <div class="cake">
      <div class="candles">
        <div class="candle"></div>
        <div class="candle"></div>
        <div class="candle"></div>
      </div>
      <div class="layer"></div>
      <div class="layer layer2"></div>
      <div class="plate"></div>
    </div>
  </div>

  <!-- popup -->
  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-label="Blow candles">
    <div class="modalCard">
      <p class="modalTitle">ðŸ’¨ Blow the candles</p>
      <p class="modalText">
        Make a wish, Kukuâ€¦ then tap the button to blow them out âœ¨
      </p>
      <button class="modalBtn" id="blowBtn">Blow âœ¨</button>
    </div>
  </div>

<script>
  /* ================= CONFIG ================= */
  const CONFIG = {
    PREVIEW_KEY: "kuku",
    UNLOCK_KEY: "birthday_unlocked", // permanent unlock
  };

  function isPreviewMode(){
    const p = new URLSearchParams(window.location.search);
    return p.get("preview") === "1" && p.get("key") === CONFIG.PREVIEW_KEY;
  }

  function isUnlockedForever(){
    // support both keys just in case
    return localStorage.getItem(CONFIG.UNLOCK_KEY) === "yes" ||
           localStorage.getItem("unlocked") === "yes";
  }

  // Access control:
  // - Preview: always allowed
  // - Live: must be permanently unlocked (after birthday click on index)
  if(!isPreviewMode() && !isUnlockedForever()){
    window.location.href = "index.html";
  }

  const go = document.getElementById("go");
  const modal = document.getElementById("modal");
  const blowBtn = document.getElementById("blowBtn");
  const cakeWrap = document.getElementById("cakeWrap");

  go.addEventListener("click", ()=>{
    // show blow popup first (no redirect yet)
    modal.classList.add("show");
  });

  blowBtn.addEventListener("click", ()=>{
    // blow candles
    document.body.classList.add("blown");

    // cake goes off screen
    cakeWrap.classList.add("off");

    // hide popup, then redirect
    setTimeout(()=>{
      modal.classList.remove("show");
    }, 450);

    setTimeout(()=>{
      if(isPreviewMode()){
        window.location.href = "card.html?preview=1&key=" + CONFIG.PREVIEW_KEY;
      } else {
        window.location.href = "card.html";
      }
    }, 1100);
  });

  // allow closing modal by clicking outside (optional nice touch)
  modal.addEventListener("click", (e)=>{
    if(e.target === modal) modal.classList.remove("show");
  });
</script>

</body>
</html>
